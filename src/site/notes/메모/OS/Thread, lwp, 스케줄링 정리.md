---
{"dg-publish":true,"permalink":"//os/thread-lwp/"}
---

- thread 는 user, kernel, hardware 3가지로 분류할 수 있다.
- 다중 스레드 모델에서 ut 와 kt 는 1:1, 1:n, n:m 방식으로 관계를 맺을 수 있다.
- n:m 모델에서 kt 와 ut 를 매핑할 때 **lwp 라는 인터페이스**를 사용한다. 
- n:m 모델을 **하이브리드 방식**이라고도 한다. 하이브리드 방식은 1:1 방식에서 시스템 자원을 많이 사용하는 단점과 1:n 방식에서 하나의 ut로 인해 전체 ut가 block 되는 현상, os 스케줄링을 사용하지 못하는 단점들을 해결하기위해 사용된다.
- 스레드가 스케줄링될 때 kt를 어떤 ut 가 선점할지 스케줄링 알고리즘을 사용해 결정해야 한다. lwp 상에서 동일한 프로세스 안의 ut 간의  스케줄링 경쟁하는 범위를 **pcs**라 한다.
- cpu 는 여러 코어를 가지고 있고 cpu 코어에서 **메모리 스톨** 현상을 최소화 하기 위해 **하드웨어 스레드**를 ( 하이퍼 스레딩 ) 여러개 둔다.
- ht 여러개 가지므로 kt 를 ht에 할당할지 결정해야한다. 이떄, 스케줄하는 경쟁 범위를 **scs** 라 한다.
- 이후에 ht 를 실제 물리 코어에 할당 해주는 작업을 수행한다.
- 만약 smp 시스템 이라면 **loadbalancing, 처리기 선호도** 여부도 또한 확인 한다.
